(function(){"use strict";angular.module("pemappApp",["ngCookies","ngResource","ngSanitize","ngRoute","html5.sortable","LocalStorageModule","ampCore","ampConfig","ampAccess"]).config(["$routeProvider",function(a){return a.when("/sections",{templateUrl:"views/section.html",controller:"SectionCtrl"}).when("/section/:sectionName/session/:sessionId/edit",{templateUrl:"views/session.html",controller:"SessionCtrl"}).when("/section/:sectionName/session/:sessionId/wall/",{templateUrl:"views/wall.html",controller:"WallCtrl"}).when("/section/:sectionName/session/:sessionId/carousel",{templateUrl:"views/carousel.html",controller:"CarouselCtrl"}).when("/studentsredirect",{templateUrl:"views/studentredirect.html",controller:"StudentRedirectCtrl"}).otherwise({redirectTo:"/sections"})}])}).call(this),function(){"use strict";angular.module("pemappApp").controller("NavCtrl",["$scope","$rootScope","$location","$routeParams","SessionsService","AuthenticationService",function(a,b,c,d,e,f){var g;return b.disableFixed=!1,b.goToWall=function(){return c.path("/section/"+d.sectionName+"/session/"+d.sessionId+"/wall/"),b.resetAnnotation()},b.saveWall=function(){return e.updateSession(),e.saveStudentExcerptCount(),a.goToWall()},b.editWall=function(){return c.path("/section/"+d.sectionName+"/session/"+d.sessionId+"/edit"),b.resetAnnotation()},b.goToSections=function(){return c.path("/sections")},b.goToCarousel=function(){return c.path("/section/"+d.sectionName+"/session/"+d.sessionId+"/carousel/"),b.resetAnnotation()},g=!1,b.annotable=!1,b.toggleAnnotation=function(){return g=!g,b.annotable=!b.annotable,b.$broadcast("annotable:toggle",{annotateMode:g})},b.undoAnnotation=function(){return b.$broadcast("annotable:undo")},b.resetAnnotation=function(){return g=!1,b.annotable=!1,b.$broadcast("annotable:toggle",{annotateMode:!1}),b.$broadcast("annotable:undo")},b.userLogOut=function(){return f.logout()}}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("SessionCtrl",["$scope","$rootScope","$routeParams","AuthenticationService","SectionsService","SessionsService",function(a,b,c,d,e,f){var g;return d.checkLogin(!0,a),e.getSections(c.sectionName,c.sessionId).then(function(a){return f.getSessions(a).then(function(){})}),a.annotable=!0,a.showRoster=!1,a.currentEditSide="",a.newSkillTags=[],a.newSkillTag="",a.editingAllowed=!0,a.editExcerpt=!1,a.attributedStudentId=null,a.attributedStudentName="",a.selectedSection,b.mode="session",b.currentPageTitle="Build Wall",b.compareMode=!1,b.disableNav=!1,a.onDrag=!1,b.studentData=[],b.newerExcerpts=[],a.Excerpt=g=function(){function c(c){this.side=c,this.boxAttr=!1,this.excerpts=[],this.excerptsLength,this.showGhost=!1,this.forcedShowGhost=!1,this.tempTag="",this.tempTags=[],this.tempExcerpt={content:"",author:"",studentId:"",excerptId:"",excerptDate:0,skills:[],spotlight:!1,editMode:!1},this.newExcerpt={content:"",author:"",studentId:"",excerptId:"",excerptDate:0,skills:[{value:"Focus on moment",checked:!1,predefined:!0},{value:"Focus in text",checked:!1,predefined:!0},{value:"Showing",checked:!1,predefined:!0},{value:"Evidence",checked:!1,predefined:!0},{value:"Logical Structure",checked:!1,predefined:!0},{value:"Transition",checked:!1,predefined:!0},{value:"Lead",checked:!1,predefined:!0},{value:"Complex sentences",checked:!1,predefined:!0},{value:"Simple sentences",checked:!1,predefined:!0},{value:"Compound sentences",checked:!1,predefined:!0}],spotlight:!1,editMode:!1},this.newTag={value:"",checked:!0,predefined:!1},this.toggleEdit=function(c){return a.editingAllowed?(this.setSideFlag(this.side),this.tempExcerpt=a.clone(c),a.editExcerpt=!0,a.attributedStudentId=c.studentId,c.editMode=!c.editMode,a.editingAllowed=!1,b.disableNav=!0):void 0},this.cancelEdit=function(b){return a.showRoster=!1,b.content=this.tempExcerpt.content,b.author=this.tempExcerpt.author,b.studentId=this.tempExcerpt.studentId,b.skills=this.tempExcerpt.skills,b.spotlight=this.tempExcerpt.spotlight,this.newTag.value=null,this.saveEdit(b)},this.saveEdit=function(c){return c.editMode=!c.editMode,b.newerExcerpts.push(c),this.removeSideFlag(),a.showRoster=!1,a.editExcerpt=!1,a.attributedStudentId=null,a.editingAllowed=!0,b.disableNav=!1},this.showGhostBox=function(){return this.showGhost=!0,this.forcedShowGhost=!0},this.hideGhostBox=function(){return this.showGhost=!1},this.showAttr=function(c){return a.editingAllowed?(this.boxAttr=!0,this.setSideFlag(c),a.editingAllowed=!1,b.disableNav=!0):void 0},this.setSideFlag=function(b){return a.currentEditSide=b},this.removeSideFlag=function(){return a.currentEditSide=null},this["delete"]=function(c){var d;return this.excerpts.splice(this.excerpts.indexOf(c),1),d=[],angular.forEach(b.newerExcerpts,function(a){return parseInt(c.excerptId)!==parseInt(a.excerptId)?d.push(a):void 0}),b.newerExcerpts=d,a.editingAllowed=!0,b.disableNav=!1,a.editExcerpt=!1,this.resetForm(c),this.removeSideFlag()},this.saveExcerpt=function(c){return c.excerptId=a.excerpts.left.length+a.excerpts.right.length+1,c.excerptDate=Date.parse(new Date),b.newerExcerpts.push(angular.copy(c)),"undefined"==typeof this.excerpts?(this.newExcerpt.push(angular.copy(c)),a.excerpts=c):this.excerpts.push(angular.copy(c)),angular.forEach(b.userData.sessions,function(c,d){return parseInt(c.sessionId)===parseInt(b.currentSession.sessionId)?b.userData.sessions[d].excerpts=a.excerpts:void 0}),this.resetForm(c)},this.resetForm=function(c){return this.clearNewExcerpt(c),a.showRoster=!1,a.newSkillTags=[],a.editingAllowed=!0,b.disableNav=!1,a.attributedStudentId=null,this.boxAttr=!1,this.newTag.value=null,this.removeSideFlag()},this.clearNewExcerpt=function(b){return b.content=null,b.author=null,b.studentId=null,b.spotlight=!1,b.editMode=!1,b.skills,a.resetProp(b.skills,"checked")},this.discardNewExcerpt=function(b){return this.resetForm(b),a.showRoster=!1,this.forcedShowGhost?(this.showGhost=!1,this.forcedShowGhost=!1):void 0},this.addTag=function(a){return this.newTag.value=this.newTag.value.trim().replace(/[^\w\s]/gi,""),0!==this.newTag.value.length?(a.skills.push(angular.copy(this.newTag)),this.newTag.value=""):void 0}}return c}(),a.leftColumn=new g("left"),a.rightColumn=new g("right"),b.$watch("userData.sessions",function(d){return angular.forEach(d,function(d){var e;return parseInt(d.sessionId)===parseInt(c.sessionId)?(b.currentSession=d,e=d.wallName,a.modifiedExcerpts=a.addAttribute(b.currentSession.excerpts,"editMode",!1),a.leftColumn.excerpts=a.modifiedExcerpts.left,a.rightColumn.excerpts=a.modifiedExcerpts.right,a.excerpts={left:a.leftColumn.excerpts,right:a.rightColumn.excerpts}):void 0})},!0),b.$watch("userSections",function(a){return b.currentSession?(angular.forEach(a,function(a){return a.id===b.currentSession.sectionKey?b.currentRoster=a.roster:void 0}),angular.forEach(b.currentRoster,function(a){return a.isActiveClass=!1})):void 0},!0),b.$watch("currentRoster",function(){return b.userData?f.getStudentLastExcerptDate().then(function(){}):void 0},!0),a.resetProp=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(c[b]=!1);return f},a.addAttribute=function(a,b,c){var d,e,f;if(a)for(e=0,f=a.length;f>e;e++)d=a[e],d[b]=c;else a=[];return a},a.divdeExcerpts=function(b){var c;c=Math.ceil(b.length/2),a.leftColumn.excerpts=b.slice(0,c),a.rightColumn.excerpts=b.slice(c)},a.clone=function(b){var c,d;if(null===b||"object"!=typeof b)return b;d=new b.constructor;for(c in b)d[c]=a.clone(b[c]);return d},a.$watch("rightColumn.excerpts.length",function(){return a.rightColumn.excerpts&&(a.rightColumnExcerptLength=a.rightColumn.excerpts.length),a.rightColumnExcerptLength>a.leftColumnExcerptLength?(a.leftColumn.showGhost=!0,a.rightColumn.showGhost=!1):(a.leftColumn.showGhost=!1,a.rightColumn.showGhost=!0)},!0),a.$watch("leftColumn.excerpts.length",function(){return a.leftColumn.excerpts&&(a.leftColumnExcerptLength=a.leftColumn.excerpts.length),a.leftColumnExcerptLength>a.rightColumnExcerptLength?(a.leftColumn.showGhost=!1,a.rightColumn.showGhost=!0):(a.leftColumn.showGhost=!0,a.rightColumn.showGhost=!1)},!0),a.selectedStudent=function(b){var c,d,e,f,g,h,i;if("anonymous"===b&&(b={firstName:"anonymous",lastName:"",key:"anonymous"}),a.editExcerpt){if("left"===a.currentEditSide)for(h=a.leftColumn.excerpts,d=0,f=h.length;f>d;d++)c=h[d],c.editMode===!0&&(c.author=b.firstName+" "+b.lastName,c.studentId=b.key);if("right"===a.currentEditSide)for(i=a.rightColumn.excerpts,e=0,g=i.length;g>e;e++)c=i[e],c.editMode===!0&&(c.author=b.firstName+" "+b.lastName,c.studentId=b.key);return a.attributedStudentId=b.key}return"left"===a.currentEditSide&&(a.leftColumn.newExcerpt.author=b.firstName+" "+b.lastName,a.leftColumn.newExcerpt.studentId=b.key),"right"===a.currentEditSide&&(a.rightColumn.newExcerpt.author=b.firstName+" "+b.lastName,a.rightColumn.newExcerpt.studentId=b.key),a.attributedStudentId=b.key},a.toggleTag=function(a){return a.checked=!a.checked},a.toggleStudentName=function(){return a.showRoster=!a.showRoster},a.deleteTag=function(a,b){return console.log("hello"),a.splice(b,1)},a.disableFixedPos=!1,b.disableScroll=!1,a.disableFixed=function(){return b.disableFixed=!0,a.disableFixedPos=!0},a.enableFixed=function(){return b.disableFixed=!1,a.disableFixedPos=!1},a.sortable_cross_option={allow_cross:!0,handle:".drag-handle",stop:function(b,c,d,e){var f,g;if(d!==e)return f=b[c],g=a.excerpts[e].indexOf(f),-1!==g?a.excerpts[e].splice(g,1):void 0}}}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("SectionCtrl",["$scope","$rootScope","$location","SectionsService","SessionsService","AuthenticationService",function(a,b,c,d,e,f){return f.checkLogin(!0,a),b.mode="sections",b.currentPageTitle="Spotlight",b.compareMode=!1,b.isEditWall=!1,d.getWallData(),a.editSession=function(a,b){return c.path("section/"+a+"/session/"+b+"/edit")},a.goToWall=function(a,b){return c.path("/section/"+a+"/session/"+b+"/wall/")},a.deleteSession=function(a,c,d){return confirm("Are you sure you want to delete "+d)===!0&&angular.forEach(b.userData.sessions,function(a,d){return c===a.sessionId?(b.userData.sessions.splice(d,1),e.updateSession()):void 0}),b.noSessions=b.userData.sessions.length>0?!1:!0}}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("WallCtrl",["$scope","$rootScope","$routeParams","AuthenticationService","SessionsService","SectionsService",function(a,b,c,d,e,f){var g;return d.checkLogin(!0,a),f.getSections(c.sectionName).then(function(a){return e.getSessions(a).then(function(){})}),b.compareMode=!1,b.mode="wall",b.currentPageTitle="Wall",b.compareText="Select a comparison...",a.leftComparison=!1,a.rightComparison=!1,a.compareFromSameSide=!1,a.compareLeft=function(){return a.leftComparison=!0},a.compareRight=function(){return a.rightComparison=!0},a.leftIndex=-1,a.rightIndex=-1,a.rightIndexOffset=1e3,a.counter=0,a.compareExcerpt=function(){return 1===a.counter?(b.compareText="Comparison View",a.counter=0):(b.compareText="Select a comparison...",b.compareMode=!0,a.counter+=1)},a.leftItemClicked=function(b,c){return-1===a.leftIndex&&(angular.element(c.target).parents("li").hasClass("right-half")&&angular.element(c.target).parents("li").removeClass("right-half"),a.leftIndex=b),b!==a.leftIndex?(angular.element(c.target).parents("li").addClass("right-half"),a.compareFromSameSide=!0):void 0},a.rightItemClicked=function(b,c){return-1===a.rightIndex&&(angular.element(c.target).parents("li").hasClass("left-half")&&angular.element(c.target).parents("li").removeClass("left-half"),a.rightIndexOffset=1e3+b,a.rightIndex=a.rightIndexOffset),b+1e3!==a.rightIndexOffset?(angular.element(c.target).parents("li").addClass("left-half"),a.compareFromSameSide=!0):void 0},b.doneComparing=function(){return b.compareMode=!1,a.rightIndexOffset=1e3,a.leftIndex=-1,a.rightIndex=-1,a.leftComparison=!1,a.rightComparison=!1,a.compareFromSameSide=!1,a.counter=0},a.Excerpt=g=function(){function b(b){this.side=b,this.boxAttr=!1,this.excerpts=[],this.excerptsLength,this.showGhost=!1,this.forcedShowGhost=!1,this.tempTag="",this.tempTags=[],this.tempExcerpt={content:"",author:"",studentId:"",theme:"",skills:[],spotlight:!1,editMode:!1},this.newExcerpt={content:"",author:"",studentId:"",theme:"",skills:[],spotlight:!1,editMode:!1},this.toggleSpotlight=function(b){var c,d;return d=b.spotlight,c=b.excerptId,angular.forEach(a.excerpts,function(a){return angular.forEach(a,function(a){return c===a.excerptId?b.spotlight=!b.spotlight:a.spotlight=!1})}),e.updateSession()}}return b}(),a.leftColumn=new g("left"),a.rightColumn=new g("right"),b.$watch("userData.sessions",function(d){return angular.forEach(d,function(d){var e;return parseInt(d.sessionId)===parseInt(c.sessionId)?(b.currentSession=d,e=d.wallName,a.modifiedExcerpts=a.addAttribute(b.currentSession.excerpts,"editMode",!1),a.leftColumn.excerpts=a.modifiedExcerpts.left,a.rightColumn.excerpts=a.modifiedExcerpts.right,a.excerpts={left:a.leftColumn.excerpts,right:a.rightColumn.excerpts}):void 0})},!0),a.addAttribute=function(a,b,c){var d,e,f;if(a)for(e=0,f=a.length;f>e;e++)d=a[e],d[b]=c;else a=[];return a},a.divdeExcerpts=function(b){var c;c=Math.ceil(b.length/2),a.leftColumn.excerpts=b.slice(0,c),a.rightColumn.excerpts=b.slice(c)}}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("CarouselCtrl",["$scope","$rootScope","$routeParams","AuthenticationService","SectionsService","SessionsService",function(a,b,c,d,e,f){return d.checkLogin(!0,a),e.getSections(c.sectionName,c.sessionId).then(function(a){return f.getSessions(a).then(function(){})}),b.mode="spotlight-carousel",b.currentPageTitle="Full Screen View",b.compareMode=!1,b.$watch("userData.sessions",function(d){return angular.forEach(d,function(d){var e;return parseInt(d.sessionId)===parseInt(c.sessionId)?(b.currentSession=d,e=d.wallName,a.excerpts=b.currentSession.excerpts,a.dataRetrieved=!0,a.allExcerpts=b.currentSession.excerpts.left.concat(b.currentSession.excerpts.right),a.spExcerpts=a.allExcerpts.filter(function(a){return a.spotlight===!1})):void 0})},!0)}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("ModalCtrl",["$scope","$location","$rootScope","dateParser","ampStorageService","SessionsService",function(a,b,c,d,e,f){return a.selectedDate=d.currentDate(),a.wallName,a.selectedSection,a.userDataTest,c.isEditWall=!1,c.dropDownDisplay=!0,c.showValueDropDown=function(a){return a?c.dropDownDisplay=!c.dropDownDisplay:void 0},c.resetModalValue=function(){return a.selectedSection="",a.wallName="",a.selectedDate=(new Date).toDateString(),c.dropDownDisplay=!0},c.populateModal=function(){return c.resetModalValue(),c.isEditWall=!0,c.dropDownDisplay=!1,c.currentSession.sectionName&&c.currentSession.sectionKey?angular.forEach(c.userSections,function(b,d){return c.currentSession.sectionKey===b.id?(a.selectedSection=c.userSections[d],a.wallName=c.currentSession.wallName,a.selectedDate=new Date(c.currentSession.date).toDateString()):void 0}):void 0},a.upDateWall=function(){return angular.forEach(c.userData.sessions,function(b,d){return parseInt(c.currentSession.sessionId)===parseInt(b.sessionId)?(c.userData.sessions[d].wallName=a.wallName,c.userData.sessions[d].date=Date.parse(a.selectedDate),c.userData.sessions[d].sectionName=a.selectedSection.name,c.userData.sessions[d].sectionKey=a.selectedSection.id,c.currentSession.sectionKey=a.selectedSection.id,f.updateSession(),c.isEditWall=!1,angular.forEach(c.userSections,function(a){return a.id===c.currentSession.sectionKey?c.currentRoster=a.roster:void 0})):void 0})},a.createSessionSubmit=function(){var e,g;return g=0===c.userData.sessions.length?1:c.userData.sessions[c.userData.sessions.length-1].sessionId+1,e={sectionName:a.selectedSection.name,sectionKey:a.selectedSection.id,wallName:a.wallName,date:Date.parse(a.selectedDate),excerptCount:0,sessionId:g,excerpts:{left:[],right:[]}},f.createSession(e).then(function(c){return c?(a.selectedDate=d.currentDate(),a.wallName="",a.selectedSection,b.path("/section/"+e.sectionName+"/session/"+e.sessionId+"/edit")):void 0})},a.$watch("selectedDate",function(b){return 0===b.length?a.selectedDate=d.currentDate():void 0},!0)}])}.call(this),function(){"use strict";angular.module("pemappApp").controller("StudentRedirectCtrl",["$rootScope","AuthenticationService",function(a,b){return a.mode="student-redirect",b.checkLogin(!0,$scope)}])}.call(this),function(){"use strict";angular.module("pemappApp").service("dateParser",function(){var a;return a="",this.currentDate=function(){return a=new Date,a=a.toDateString()},a})}.call(this),function(){"use strict";angular.module("pemappApp").service("SectionsService",["$rootScope","ampSectionService","SessionsService","ampRosterService",function(a,b,c,d){return{getSections:function(){return a.currentSession,a.userSections=[],b.fetch().then(function(b){return b?angular.forEach(b,function(b){return d.read(b.section.key).then(function(c){return a.userSections.push({name:b.section.name,id:b.section.key,roster:c})})}):void 0})},getWallData:function(){return a.userSections=[],b.fetch().then(function(b){return b?(angular.forEach(b,function(a){return this.push({name:a.section.name,id:a.section.key})},a.userSections),c.getSessions(b)):void 0})}}}])}.call(this),function(){"use strict";angular.module("pemappApp").service("SessionsService",["$rootScope","$http","$q","$parse","$location","$routeParams","ampSectionService","ampStorageService",function(a,b,c,d,e,f,g,h){return{getSessions:function(b){var c,e;return a.userData={userName:b[0].user.firstName+" "+b[0].user.lastName,userId:b[0].key,sessions:[],sections:b},c="spotlight",e=a.userData.userId+"-spotlight-data",h.read(c,e).then(function(b){return b?(angular.forEach(b,function(b){return a.userData=d(b.data)(a)}),a.noSessions=a.userData.sessions.length>0?!1:!0):a.noSessions=!0})},createSession:function(b){var c,d,e;return c="spotlight",e=a.userData.userId+"-spotlight-data",d=angular.toJson(a.userData,!0),h.read(c,e).then(function(){return a.userData.sessions.push(b),d=angular.toJson(a.userData,!0),h.create(c,e,d).then(function(a){return console.log(a),a?!0:void 0})})},updateSession:function(){var b,c,d;return b="spotlight",d=a.userData.userId+"-spotlight-data",c=angular.toJson(a.userData,!0),h.create(b,d,c).then(function(a){return a?!0:void 0})},getStudentLastExcerptDate:function(){var b,c,e,f;return b="spotlight",e="",f="",c=a.userData.userId+"-"+a.currentSession.sectionKey+"-last-excerpt-date",h.read(b,c).then(function(b){return angular.forEach(b,function(a){return f=d(a.data)(e)}),angular.forEach(f,function(b){return angular.forEach(a.currentRoster,function(c,d){var e,f,g;return c.key===b.studentId?(e=new Date(b.lastDate),f=new Date,g=new Date(f.getTime()-e.getTime()),g=g.getUTCDate()-1,a.currentRoster[d].lastExcerptDate=g,a.currentRoster[d].pastExcerpt=!0):void 0})})})},saveStudentExcerptCount:function(){var b,c,e,f,g,i,j;return g=a.userData.userId+"-"+a.currentSession.sectionKey+"-last-excerpt-date",f="",j="",b=a.$$childTail.excerpts?a.$$childTail.excerpts.left.concat(a.$$childTail.excerpts.right):[{left:[],right:[]}],c="spotlight",i=[],e=[],g=a.userData.userId+"-"+a.currentSession.sectionKey+"-last-excerpt-date",h.read(c,g).then(function(e){var k;return e?(k=[],angular.forEach(e,function(b){return j=d(b.data)(i),angular.forEach(a.newerExcerpts,function(b){var c;return c=!1,angular.forEach(j,function(a,d){return b.studentId===a.studentId?j[d].lastDate=b.excerptDate:c=!0}),c===!0?j.push({teacherId:a.userData.userId,excerptId:b.excerptId,studentId:b.studentId,studentName:b.author,lastDate:b.excerptDate}):void 0})}),f=angular.toJson(j,!1),h.create(c,g,f).then(function(){})):(j=[],angular.forEach(b,function(b){var c;return c=b.studentId,j.push({teacherId:a.userData.userId,excerptId:b.excerptId,studentId:b.studentId,studentName:b.author,lastDate:b.excerptDate})}),f=angular.toJson(j,!1),h.create(c,g,f).then(function(){}))})}}}])}.call(this),function(){"use strict";angular.module("pemappApp").service("AuthenticationService",["ampAccessService","$location",function(a,b){return{checkLogin:function(c,d){a.canRestoreSession().then(function(e){d.curstatus=e,d.isTeacher=!1,d.isStudent=!1,angular.forEach(d.curstatus.roles,function(a){"ROLE_TEACHER"===a?d.isTeacher=!0:"ROLE_STUDENT"===a&&(d.isStudent=!0)}),d.isStudent===!0?b.path("/studentsredirect"):e.authenticated&&e.authenticated===!0&&d.isTeacher===!0?(console.log("authenticated"),console.log(e)):c&&a.redirectToLoginPage()},function(a){console.log("Failed: "+a)},function(a){console("Got notification: "+a)})},logout:function(){var b;b=this,a.logout().then(function(){console.log("Logged Out."),a.redirectToLoginPage()},function(a){console.log("Failed to logout: "+a)},function(a){alert("Got notification: "+a)}),console.log("logging you out...")}}}])}.call(this),function(){"use strict";angular.module("pemappApp").directive("pemaModal",function(){return function(a,b,c){return navigator.userAgent.match(/iPhone|iPad|iPod/i)&&$(".modal").on("show.bs.modal",function(){$(this).css({position:"absolute",marginTop:$(window).scrollTop()+"px",bottom:"auto"}),$(".modal").hasClass("in")&&$(".modal").css({marginTop:"0%"}),setTimeout(function(){$(".modal-backdrop").css({position:"absolute",top:0,left:0,width:"100%",height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)+"px"})},0)}),b.bind("click",function(){return b.hasClass("disabled")?void 0:"false"===c.modalHidden?angular.element("#"+c.pemaModal).modal():(angular.element("#"+c.pemaModal).modal("hide"),angular.element(".modal-backdrop").hide())})}})}.call(this),function(){"use strict";angular.module("pemappApp").directive("fixSelect",function(){return{require:"ngModel",link:function(a,b,c,d){var e,f,g;e=function(a,b){var c;for(c=b.split(".");c.length&&(a=a[c.shift()]););return a},g=function(){var b;b=e(a,f),angular.forEach(b,function(a){angular.equals(a,d.$viewValue)&&d.$setViewValue(a)})},f=c.fixSelect,a.$watch(c.fixSelect,g),a.$watch(function(){return d.$viewValue},g)}}})}.call(this),function(){"use strict";angular.module("pemappApp").directive("annotable",function(){return{replace:!0,transclude:!0,template:'<div>                    <div class="annotable-layer" ng-class="{\'hidden\': !enabled}">                        <canvas></canvas>                    </div>                    <div class="annotable-transclude" ng-transclude></div>                   </div>',restrict:"A",link:function(a,b){var c,d;return d=b.find("canvas").eq(0),c=new fabric.Canvas(d[0],{isDrawingMode:!0}),c.freeDrawingBrush.width=5,c.freeDrawingBrush.color="yellow",a.$on("annotable:toggle",function(d,e){var f,g;return f=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-55,console.log(f),g=b.width(),a.enabled&&!e.annotateMode?(console.log("clearing the layer"),c.clear()):(c.setHeight(f>=b.height()?f:b.height()),c.setWidth(b.width()),c.renderAll(),c.on("after:render",function(){return c.calcOffset()})),a.enabled=e.annotateMode}),a.$on("annotable:undo",function(){return console.log("clear"),c.clear()}),window.onresize=function(){var a;return a=Math.max(document.documentElement.clientHeight,window.innerHeight||0)-55,c.setHeight(b.height()>a?b.height():a),c.setWidth(b.width())}}}})}.call(this),function(){"use strict";angular.module("pemappApp").directive("pemaDatepicker",function(){return{restrict:"A",link:function(a,b){return b.attr("readOnly",!0),b.datepicker({format:"D, d MM, yyyy",pickTime:!1}).on("changeDate",function(){return b.datepicker("hide")})}}})}.call(this),function(){"use strict";angular.module("pemappApp").directive("slider",["$timeout","SessionsService",function(a,b){return{template:'<a class="backward"><i><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="44.945px" height="45px" viewBox="0 0 44.945 45" style="enable-background:new 0 0 44.945 45;" xml:space="preserve"><g class="back-svg">  <path d="M22.464,41.561c-0.025,0-0.055,0-0.08,0C12.088,41.518,3.314,32.966,3.404,22.299C3.492,11.948,12.059,3.407,22.476,3.407    c0.048,0,0.096,0,0.145,0c10.348,0.078,18.98,8.641,18.898,19.062C41.603,32.994,32.84,41.561,22.464,41.561 M22.452,0    c-0.018,0-0.036,0-0.055,0C9.981,0.028,0.04,9.903,0,22.377C-0.042,35.089,10.056,44.841,22.448,45    c12.479-0.141,22.482-9.951,22.498-22.513C44.959,10.069,35.088-0.001,22.452,0"/>  <path d="M24.288,12.954c-0.369,0-0.746,0.152-1.062,0.464c-2.693,2.655-5.379,5.317-8.047,7.997    c-0.265,0.265-0.385,0.672-0.591,1.052c0.204,0.397,0.306,0.792,0.555,1.042c2.683,2.695,5.387,5.369,8.09,8.045    c0.292,0.289,0.632,0.441,1.015,0.441c0.125,0,0.253-0.016,0.387-0.049c0.922-0.229,1.541-1.477,0.519-2.47    c-2.208-2.146-4.383-4.33-6.597-6.472c-0.434-0.419-0.401-0.658,0.012-1.061C20.793,19.787,23,17.607,25.2,15.42    c0.646-0.643,0.653-1.449,0.075-2.038C24.998,13.1,24.647,12.954,24.288,12.954"/></g></svg></i></a>              <a class="forward"><i><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"   width="44.977px" height="45px" viewBox="0 0 44.977 45" style="enable-background:new 0 0 44.977 45;" xml:space="preserve"><g class="foward-svg">  <path d="M22.497,41.561c0.025,0,0.055,0,0.08,0C32.88,41.518,41.66,32.966,41.57,22.299C41.482,11.948,32.91,3.407,22.485,3.407    c-0.048,0-0.096,0-0.145,0C11.985,3.485,3.347,12.048,3.429,22.471C3.345,32.994,12.114,41.561,22.497,41.561 M22.509,0    c0.018,0,0.036,0,0.055,0c12.424,0.028,22.373,9.903,22.413,22.377C45.019,35.089,34.914,44.841,22.514,45    C10.025,44.859,0.016,35.048,0,22.487C-0.014,10.069,9.864-0.001,22.509,0"/>  <path d="M20.672,12.954c0.369,0,0.747,0.152,1.063,0.464c2.695,2.655,5.384,5.317,8.054,7.997c0.264,0.265,0.384,0.672,0.591,1.052    c-0.205,0.397-0.306,0.792-0.555,1.042c-2.685,2.695-5.392,5.369-8.097,8.045c-0.292,0.289-0.632,0.441-1.016,0.441    c-0.125,0-0.253-0.016-0.387-0.049c-0.923-0.229-1.542-1.477-0.52-2.47c2.209-2.146,4.386-4.33,6.602-6.472    c0.434-0.419,0.4-0.658-0.013-1.061c-2.228-2.159-4.437-4.339-6.638-6.526c-0.646-0.643-0.653-1.449-0.075-2.038    C19.962,13.1,20.312,12.954,20.672,12.954"/></g></svg></i></a><div class="swiper-wrapper-annotable" annotable></div>                <div class="swiper-wrapper">                  <div class="swiper-slide" ng-class="{spotlight:excerpt.spotlight}" ng-repeat="excerpt in excerpts">                                        <div class="slide-wrapper" >                      <cite ng-if="excerpt.author != \'anonymous \'">{{excerpt.author}}</cite>                      <cite class="student-name-anonymous" ng-if="excerpt.author == \'anonymous \'">{{excerpt.author}}</cite>                      <article>{{excerpt.content}}</article>                     <div class="saved-excerpt-tag-wrapper tag-select">              <span class="saved-excerpt-tag" ng-repeat="skill in excerpt.skills" ng-if="excerpt.skills[$index].checked == true">{{excerpt.skills[$index].value}}</span>            </div>                    </div>                                    <i class="excerpt-mode-icon"  ng-click="toggleSpotlight(excerpt)" ng-class="{spotlight:excerpt.spotlight}" >                  <span class="spotlight-wrapper">                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"                       width="27.973px" height="27.997px" viewBox="0 0 27.973 27.997" style="enable-background:new 0 0 27.973 27.997;"                       xml:space="preserve">                    <g class="spotlight-svg">                      <path  d="M25.494,2.503C23.884,0.842,22.662,0,21.861,0c-0.346,0-0.665,0.129-0.897,0.364L17.38,3.95                        c-0.292,0.292-0.681,0.439-0.972,0.512C16.206,4.484,16.005,4.514,15.8,4.55c-3.953,0.702-7.725,3.741-8.255,4.271                        C6.8,9.564,6.914,10.807,7.882,12.513c0.741,1.306,1.934,2.812,3.358,4.235c2.021,2.021,4.829,4.184,6.655,4.184l0,0                        c0.646,0,1.043-0.264,1.266-0.484c0.528-0.531,3.565-4.308,4.267-8.264c0.035-0.202,0.065-0.405,0.087-0.606                        c0.073-0.292,0.22-0.681,0.512-0.974l3.583-3.586c0.237-0.237,0.366-0.56,0.363-0.91C27.967,5.307,27.126,4.087,25.494,2.503z                         M22.611,9.187c-0.646,0.649-0.934,1.444-1.06,1.996l-0.02,0.122c-0.019,0.177-0.045,0.355-0.075,0.531                        c-0.563,3.177-3.01,6.397-3.616,7.09c-0.736-0.055-2.771-1.178-5.187-3.596c-2.524-2.524-3.562-4.567-3.596-5.186                        c0.687-0.603,3.907-3.058,7.085-3.622c0.178-0.031,0.356-0.058,0.533-0.076l0.122-0.021c0.552-0.127,1.347-0.414,1.994-1.061                        l3.231-3.234c0.477,0.304,1.319,1.031,2.054,1.787c0.737,0.716,1.461,1.558,1.765,2.033L22.611,9.187z"/>                      <path d="M9.535,18.454c-0.354-0.353-0.969-0.354-1.321,0l-5.659,5.664c-0.364,0.364-0.364,0.959,0,1.321                        c0.176,0.177,0.411,0.274,0.661,0.274s0.484-0.098,0.661-0.274l5.659-5.663C9.899,19.413,9.9,18.818,9.535,18.454z"/>                      <path d="M12.714,21.163c-0.45-0.229-0.999-0.099-1.194,0.285l-2.695,5.295c-0.088,0.17-0.102,0.371-0.039,0.564                        c0.077,0.236,0.263,0.445,0.508,0.57c0.152,0.078,0.319,0.121,0.482,0.121c0.317,0,0.583-0.151,0.712-0.406l2.696-5.295                        c0.106-0.207,0.103-0.455-0.011-0.682C13.08,21.426,12.917,21.266,12.714,21.163z"/>                      <path d="M6.936,15.911c0.035-0.209-0.003-0.435-0.105-0.639c-0.229-0.449-0.748-0.667-1.135-0.471L0.404,17.5                        c-0.207,0.105-0.349,0.309-0.391,0.557c-0.036,0.208,0.002,0.436,0.106,0.637c0.169,0.333,0.488,0.549,0.812,0.549                        c0.113,0,0.221-0.025,0.321-0.076l5.291-2.697C6.751,16.363,6.894,16.161,6.936,15.911z"/>                    </g>                    </svg>                     </span>                    <span class="spotlight-wrapper-on">                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"                       width="27.973px" height="27.997px" viewBox="0 0 27.973 27.997" style="enable-background:new 0 0 27.973 27.997;"                       xml:space="preserve">                    <g class="spotlight-svg-on">                      <path d="M25.494,2.503C23.884,0.842,22.662,0,21.861,0c-0.346,0-0.665,0.129-0.897,0.364L17.38,3.95                        c-0.292,0.292-0.681,0.439-0.972,0.512C16.206,4.484,16.005,4.514,15.8,4.55c-3.953,0.702-7.725,3.741-8.255,4.271                        C6.8,9.564,6.914,10.807,7.882,12.513c0.741,1.306,1.934,2.812,3.358,4.235c2.021,2.021,4.829,4.184,6.655,4.184l0,0                        c0.646,0,1.043-0.264,1.266-0.484c0.528-0.531,3.565-4.308,4.267-8.264c0.035-0.202,0.065-0.405,0.087-0.606                        c0.073-0.292,0.22-0.681,0.512-0.974l3.583-3.586c0.237-0.237,0.366-0.56,0.363-0.91C27.967,5.307,27.126,4.087,25.494,2.503z"/>                      <path d="M9.535,18.454c-0.354-0.353-0.97-0.354-1.321,0l-5.659,5.664c-0.364,0.364-0.364,0.959,0,1.321                        c0.176,0.177,0.411,0.274,0.661,0.274s0.484-0.098,0.661-0.274l5.659-5.663C9.899,19.413,9.9,18.818,9.535,18.454z"/>                      <path d="M12.714,21.163c-0.45-0.229-0.999-0.099-1.194,0.285l-2.695,5.295c-0.088,0.17-0.102,0.371-0.039,0.564                        c0.077,0.236,0.263,0.445,0.508,0.57c0.152,0.078,0.319,0.121,0.482,0.121c0.317,0,0.583-0.151,0.712-0.406l2.696-5.295                        c0.106-0.207,0.103-0.455-0.011-0.682C13.08,21.426,12.917,21.266,12.714,21.163z"/>                      <path d="M6.936,15.911c0.035-0.209-0.003-0.435-0.105-0.639c-0.229-0.449-0.748-0.667-1.135-0.471L0.404,17.5                        c-0.207,0.105-0.349,0.309-0.391,0.557c-0.036,0.208,0.002,0.436,0.106,0.637c0.169,0.333,0.488,0.549,0.812,0.549                        c0.113,0,0.221-0.025,0.321-0.076l5.291-2.697C6.751,16.363,6.894,16.161,6.936,15.911z"/>                    </g>                    </svg>                    </span>                </i>                </div>                </div>              ',restrict:"A",scope:{excerpts:"="},link:function(a,c){return a.toggleSpotlight=function(c){var d,e;
return e=c.spotlight,d=c.excerptId,angular.forEach(a.excerpts,function(a){return a.spotlight=d===a.excerptId?!a.spotlight:!1}),b.updateSession()},a.$watch("excerpts",function(a){var b;return a?(b=c.swiper({mode:"horizontal",createPagination:!1,loop:!1,keyboardControl:!0,resizeReinit:!0,onSlideChangeStart:function(){return 0===b.activeIndex?(angular.element(".backward").hide(),angular.element(".forward").show()):b.activeIndex===b.slides.length-1?(angular.element(".backward").show(),angular.element(".forward").hide()):(angular.element(".backward").show(),angular.element(".forward").show())}}),angular.element(".forward i").on("click",function(){b.swipeNext()}),angular.element(".backward i").on("click",function(){b.swipePrev()})):void 0})}}}])}.call(this),function(){"use strict";angular.module("pemappApp").directive("scrollTop",function(){return{restrict:"A",link:function(a,b){b.on("click",function(a){var c;console.log(a.target),console.log(b.offset().top),c=angular.element(a.target).offset().top,angular.element("body").animate({scrollTop:b.offset().top-60},400)})}}})}.call(this),function(){"use strict";angular.module("pemappApp").directive("toggleDraggable",function(){return{restrict:"A",link:function(a,b,c){return b.on("click",function(){return"false"===c.toggleDraggable?angular.element(".hidden-modal").removeClass("disable"):angular.element(".hidden-modal").addClass("disable")})}}})}.call(this),function(a,b){"use strict";var c=function(a){var b=function(){var b=$q.defer();return b.resolve({error:a}),b.promise};return b},d="/auth/sso/login?redirect_url=",e="%23%2Frestoresession",f="/auth/sso/status",g="/auth/sso/logout",h="/auth/sso/callback",i="/data/purchasedCourse/courseEntitlements",j={authenticated:!1},k={message:"Logged out",authenticated:!1},l={withCredentials:!0};b.module("ampAccess",["ampConfig"]).service("ampEntitlementService",["$window","ampConfigService","$http","$q",function(a,d,e,f){var g=function(){var a=f.defer();return d.csApiUrlBuilder(i).then(function(b){e.get(b,{withCredentials:!0}).success(function(b){a.resolve(b)}).error(function(){a.resolve([])})}),a.promise},j=function(a){if(!a||!b.isString(a))throw new Error("ampEntitlementService.read requires a publicId:String");var c=f.defer();return d.csApiUrlBuilder(i).then(function(a){e.get(a,{withCredentials:!0}).success(function(a){c.resolve(a)}).error(function(){c.resolve(null)})}),c.promise},k=function(c){if(!c||!b.isString(c))throw new Error("ampEntitlementService.entitlementOrRedirect requires a publicId:String");j(c).then(function(b){b||d.csBaseUrlBuilder(h).then(function(b){a.location.assign(b)})})},l=c(f,"ampEntitlementService.create' has not been implemented."),m=c(f,"ampEntitlementService.update' has not been implemented."),n=c(f,"ampEntitlementService.delete' has not been implemented.");return{fetch:g,create:l,read:j,update:m,"delete":n,entitlementOrRedirect:k}}]).service("ampAccessService",["ampConfigService","$http","$q","$window",function(a,h,i,m){var n=function(){var c=i.defer();return a.csBaseUrlBuilder(f).then(function(a){h.get(a,l).success(function(a){c.resolve(a)}).error(function(){c.resolve(b.copy(j))})}),c.promise},o=function(){var c=i.defer();return a.csBaseUrlBuilder(g).then(function(a){h.get(a,l),c.resolve(b.copy(k))}),c.promise},p=function(){a.csBaseUrlBuilder(d).then(function(a){m.location.assign(a+m.location.origin+encodeURIComponent(m.location.pathname)+e)})};return{canRestoreSession:n,logout:o,redirectToLoginPage:p,restoreSession:c("ampAccessService.restoreSession' has not been implemented."),create:p,read:n,update:c("ampAccessService.update' has not been implemented."),"delete":o}}])}(window,window.angular),function(a,b){"use strict";var c=function(a,b){var c=function(){var c=a.defer();return c.resolve({error:b}),c.promise};return c},d=function(a){var b=function(b){a.resolve(b)};return b},e=function(a){var b=function(){a.resolve([])};return b},f=function(a){var b=function(){a.resolve(null)};return b},g={withCredentials:!0};b.module("ampCore",["ampConfig"]).service("ampSectionService",["ampConfigService","$http","$q",function(a,b,f){var h="/action/user/currentSections",i=function(){var c=f.defer();return a.csApiUrlBuilder(h).then(function(a){b.get(a,g).success(d(c)).error(e(c))}),c.promise},j=c(f,"ampSectionService.read' has not been implemented."),k=c(f,"ampSectionService.create' has not been implemented."),l=c(f,"ampSectionService.update' has not been implemented."),m=c(f,"ampSectionService.delete' has not been implemented.");return{fetch:i,create:k,read:j,update:l,"delete":m}}]).service("ampRosterService",["ampConfigService","$http","$q","ampSectionService",function(a,f,g){var h=c(g,"ampRosterService.fetch' has not been implemented."),i=function(c){if(!c||!b.isString(c))throw new Error("ampRosterService.read requires a single parameter, sectionKey:String");var h="/data/section/"+c+"/studentRoster/student",i=g.defer();return a.csApiUrlBuilder(h).then(function(a){f.get(a,{withCredentials:!0}).success(d(i)).error(e(i))}),i.promise},j=c(g,"ampRosterService.delete' has not been implemented."),k=c(g,"ampRosterService.create' has not been implemented."),l=c(g,"ampRosterService.update' has not been implemented.");return{fetch:h,create:k,read:i,update:l,"delete":j}}]).service("ampStorageService",["ampConfigService","$http","$q","$window",function(a,c,h){var i="/api/storage/",j=function(f){if(!f||!b.isString(f))throw new Error("ampStorageService.fetch requires a single parameter, applicationName:String");var j=h.defer(),k=i+f;return a.csBaseUrlBuilder(k).then(function(a){c.get(a,g).success(d(j)).error(e(j))}),j.promise},k=function(e){if(!e||!b.isString(e))throw new Error("ampStorageService.burn requires a single parameter, applicationName:String");var j=h.defer(),k=i+e;return a.csBaseUrlBuilder(k).then(function(a){c.delete(a,g).success(d(j)).error(f(j))}),j.promise},l=function(e,j){if(!e||!b.isString(e))throw new Error("ampStorageService.read requires a first parameter, applicationName:String");if(!j||!b.isString(j))throw new Error("ampStorageService.read requires a second parameter, fileName:String");var k=h.defer(),l=i+e+"/"+j;return a.csBaseUrlBuilder(l).then(function(a){c.get(a,g).success(d(k)).error(f(k))}),k.promise},m=function(e,g,j){if(!e||!b.isString(e))throw new Error("ampStorageService.create requires a first parameter, applicationName:String");if(!g||!b.isString(g))throw new Error("ampStorageService.create requires a second parameter, fileName:String");if(!j||!b.isString(j))throw new Error("ampStorageService.create requires a third parameter, fileData:String");var k=h.defer(),l=i+e+"/"+g;return a.csBaseUrlBuilder(l).then(function(a){c({url:a,method:"POST",data:j,headers:{"Content-Type":"application/base64"},params:{createOrUpdate:!0},withCredentials:!0}).success(d(k)).error(f(k))}),k.promise},n=function(e,j){if(!e||!b.isString(e))throw new Error("ampStorageService.delete requires a first parameter, applicationName:String");if(!j||!b.isString(j))throw new Error("ampStorageService.delete requires a second parameter, fileName:String");var k=h.defer(),l=i+e+"/"+j;return a.csBaseUrlBuilder(l).then(function(a){c.delete(a,g).success(d(k)).error(f(k))}),k.promise};return{fetch:j,burn:k,create:m,read:l,update:m,"delete":n}}]).service("ampUnitService",["ampConfigService","$http","$q",function(a,f,h){var i=function(c){if(!c||!b.isString(c))throw new Error("ampUnitService.read requires a single parameter, sectionKey:String");var i=h.defer();return a.csApiUrlBuilder("/data/section/"+c+"/enactedUnit").then(function(a){f.get(a,g).success(d(i)).error(e(i))}),i.promise},j=c(h,"ampUnitService.read' has not been implemented."),k=c(h,"ampUnitService.create' has not been implemented."),l=c(h,"ampUnitService.update' has not been implemented."),m=c(h,"ampUnitService.delete' has not been implemented.");return{fetch:i,create:k,read:j,update:l,"delete":m}}]).service("ampActivityService",["ampConfigService","$http","$q",function(a,f,h){var i="/data/component/element/activity/",j=function(c){if(!c||!b.isString(c))throw new Error("ampActivityService.read requires a first parameter, key:String");var j=h.defer(),k=i+c;return a.csApiUrlBuilder(k).then(function(a){f.get(a,g).success(d(j)).error(e(j))}),j.promise},k=c(h,"ampActivityService.create' has not been implemented."),l=c(h,"ampActivityService.fetch' has not been implemented."),m=c(h,"ampActivityService.update' has not been implemented."),n=c(h,"ampActivityService.delete' has not been implemented.");return{fetch:l,create:k,read:j,update:m,"delete":n}}]).service("ampComponentService",["ampConfigService","$http","$q",function(a,h,i){var j="child_of_unit",k="child_of_component",l="user_component",m="lesson_component",n=[l,k,j,m],o="/action/interact/submit/userComponent",p="/action/interact/submit/userComponent/complete",q=function(c,f){if(f=f||k,n.indexOf(f)<0)throw new Error("ampComponentService.fetch requires a valid componentType - "+f+" does not match "+b.toJson(n));if(!c||!b.isString(c))throw new Error("ampComponentService.fetch requires a first parameter, key:String");var o=i.defer(),p=f===k&&"/api/0.1/data/enactedComponent/"+c+"/enactedElement"||f===j&&"/api/0.1/data/enactedUnit/"+c+"/enactedComponent"||f===l&&"/api/0.1/data/enactedComponent/"+c+"/userComponent"||f===m&&"/api/lesson/"+c||"/data/enactedComponent/"+c+"/enactedElement";return a.csBaseUrlBuilder(p).then(function(a){h.get(a,g).success(d(o)).error(e(o))}),o.promise},r=function(c,e,j){if(!c||!b.isString(c))throw new Error("ampComponentService.submit requires a first parameter, userComponentKey:String");if(!e||!b.isArray(e))throw new Error("ampComponentService.submit requires a second parameter, activityKeyAndResponseList:Array");if(null===j||void 0===j)throw new Error("ampComponentService.submit requires a third parameter, isComplete:Boolean");var k=0,l=e.length;for(k=0;l>k;k++){var m=e[k];if(!m.key||!b.isString(m.key))throw new Error("ampComponentService.submit activityKeyAndResponseList["+k+"] must have a key:String property");if(!m.response||!b.isString(m.response))throw new Error("ampComponentService.submit activityKeyAndResponseList["+k+"] must have a response:String property")}var n={userComponentKey:c,submission:{responses:e}},q=i.defer(),r=j&&p||o;return a.csApiUrlBuilder(r).then(function(a){h.post(a,n,g).success(d(q)).error(f(q))}),q.promise},s=c(i,"ampComponentService.create' has not been implemented."),t=c(i,"ampComponentService.read' has not been implemented."),u=c(i,"ampComponentService.update' has not been implemented."),v=c(i,"ampComponentService.delete' has not been implemented.");return{fetch:q,create:s,read:t,update:u,"delete":v,submit:r,CHILD_OF_COMPONENT:k,CHILD_OF_UNIT:j,LESSON:m,USER:l}}]).service("ampCurriculumService",["ampConfigService","$http","$q","ampComponentService",function(a,c,h,i){var j=function(a,c,d,e){if(!a||!b.isString(a))throw new Error("ampCurriculumService.createCardSubmission requires a first parameter, cardKey:String");if(!c||!b.isString(c))throw new Error("ampCurriculumService.createCardSubmission requires a second parameter, userKey:String");if(!d)throw new Error("ampCurriculumService.createCardSubmission requires a third parameter, jsonData:String");if(null===e||void 0===e)throw new Error("ampCurriculumService.createCardSubmission requires a fourth parameter, isComplete:Boolean");var f=h.defer();return i.fetch(a,i.USER).then(function(b){var g=0,h=b.length,j=!1;for(g=0;h>g;g++){var k=b[g];if(k.User.userkey===c){if(j=!0,k.useractivities.length<=0)throw new Error("ampCurriculumService.createCardSubmission can only operate on a card with an activity (card: "+a+" has zero activities, and so has no submission data.");if(k.useractivities.length>1)throw new Error("ampCurriculumService.createCardSubmission can only operate on a card with a single activity (card: "+a+" has "+k.useractivities.length+" activities. Please select a different card or author it to have fewer activities.");var l=(k.User.firstname,k.User.lastname,k.entity,k.unitofworkkey,k.unitofworkLastsubmittedts,k.enactedcomponentkey,k.useractivities[0].enactedactivitykey,k.useractivities[0].useractivitykey),m=k.usercomponentkey,n=[{key:l,response:d}];i.submit(m,n,e).then(function(a){f.resolve(a)})}}if(!j)throw f.resolve(null),new Error("ampCurriculumService.createCardSubmission can only submit for a given userKey. "+c+" could not be found and is not associated (or does not have rights) to this activity and/or session.")}),f.promise},k=function(a){if(!a||!b.isString(a))throw new Error("ampCurriculumService.createCardSubmission requires a first parameter, cardKey:String");var c=h.defer();return i.fetch(a,i.USER).then(function(b){var d={},e=0,f=b.length;for(e=0;f>e;e++){var g=b[e];if(g.useractivities.length<=0)throw new Error("ampCurriculumService.readCardSubmission can only operate on a card with an activity (card: "+a+" has zero activities, and so has no submission data.");if(g.useractivities.length>1)throw new Error("ampCurriculumService.readCardSubmission can only operate on a card with a single activity (card: "+a+" has "+g.useractivities.length+" activities. Please select a different card or author it to have fewer activities.");var h=g.User.userkey,i=g.User.firstname,j=g.User.lastname,k=g.entity,l=g.unitofworkkey,m=g.unitofworklastsubmittedts,n=g.enactedcomponentkey,o=g.useractivities[0].enactedactivitykey,p=g.useractivities[0].useractivitykey,q=g.usercomponentkey,r=[],s=0,t=g.submissions.length;for(s=0;t>s;s++){var u=g.submissions[s],v={enactedActivityKey:u.responses[0].enactedactivitykey,userActivityKey:u.responses[0].useractivitykey,response:u.responses[0].response,key:u.submissionkey,time:u.submissiontime};r.push(v)}var w={user:{firstName:i,lastName:j,key:h},submissions:r,entity:k,enactedComponentKey:n,enactedActivityKey:o,userActivityKey:p,userComponentKey:q,unitOfWorkKey:l,unitOfWorkLastSubmittedTs:m};d[h]=w}c.resolve(d)}),c.promise},l=function(e){if(!e||!b.isString(e))throw new Error("ampCurriculumService.assignCardstack requires a first parameter, cardStackKey:String");var i=h.defer(),j="";return a.csApiUrlBuilder("/action/interact/enactedComponent/"+e+"/assign").then(function(){c.put(j,g).success(d(i)).error(f(i))}),i.promise},m=function(d){if(!d||!b.isString(d))throw new Error("ampCurriculumService.readGradesForCardstack requires a first parameter, cardStackKey:String");var f=h.defer();return a.csApiUrlBuilder("/view/gradebook/enactedcomponent/"+d+"/unitofwork").then(function(a){c.get(a,g).success(function(a){var b={},c=0,d=a.unitofworks.length;for(c=0;d>c;c++){var e=a.unitofworks[c];b[e.userkey]=e}f.resolve(b)}).error(e(f))}),f.promise},n=function(f,i){if(!f||!b.isString(f))throw new Error("ampCurriculumService.assignGradeForUnitOfWork requires a first parameter, unitOfWorkKey:String");if(!i||!b.isString(i))throw new Error("ampCurriculumService.assignGradeForUnitOfWork requires a second parameter, grade:String");var j=h.defer(),k={gradeText:i};return a.csApiUrlBuilder("/grade/unitOfWork/"+f).then(function(a){c.post(a,k,g).success(d(j)).error(e(j))}),j.promise},o=function(a,c,d){if(!a||!b.isString(a))throw new Error("ampCurriculumService.assignGradeForCardstack requires a first parameter, cardStackKey:String");if(!c||!b.isString(c))throw new Error("ampCurriculumService.assignGradeForCardstack requires a second parameter, userKey:String");if(!d||!b.isString(d))throw new Error("ampCurriculumService.assignGradeForCardstack requires a third parameter, grade:String");var e=h.defer();return m(a).then(function(a){var b=a[c];b?n(b.key,d).then(function(a){e.resolve(a)}):e.resolve(null)}),e.promise};return{createCardSubmission:j,readCardSubmission:k,assignCardstack:l,assignGradeForCardstack:o,assignGradeForUnitOfWork:n,readGradesForCardstack:m}}]).filter("cardStackKeyToGrades",["ampCurriculumService",function(a){var b={},c=null;return function(d,e){e=e||"",c!==e&&(c=e,b={});var f=b[d];return f||(f={},b[d]=f,a.readGradesForCardstack(d).then(function(a){b[d]=a})),f}}]).filter("cardKeyToSubmissions",["ampCurriculumService",function(a){var b={},c=null;return function(d,e){e=e||"",c!==e&&(c=e,b={});var f=b[d];return f||(f={},b[d]=f,a.readCardSubmission(d).then(function(a){b[d]=a})),f}}]).filter("activityKeyToActivity",["ampActivityService",function(a){var b={},c=null;return function(d,e,f){f=f||"",c!==f&&(c=f,b={});var g=b[d];return g||(g={},b[d]=g,a.read(d,e).then(function(a){b[d]=a})),g}}]).filter("componentKeyToComponents",["ampComponentService",function(a){var b={},c=null;return function(d,e,f){f=f||"",c!==f&&(c=f,b={});var g=b[d];return g||(g={},b[d]=g,a.fetch(d,e).then(function(a){b[d]=a})),g}}]).filter("sectionKeyToRoster",["ampRosterService",function(a){var b={},c=null;return function(d,e){e=e||"",c!==e&&(c=e,b={}),d+="";var f=b[d];return f||(f={},b[d]=f,a.read(d).then(function(a){b[d]=a})),f}}]).filter("sectionKeyToUnits",["ampUnitService",function(a){var b={},c=null;return function(d,e){e=e||"",c!==e&&(c=e,b={}),d+="";var f=b[d];return f||(f={},b[d]=f,a.fetch(d).then(function(a){b[d]=a})),f}}])}(window,window.angular),function(a,b){"use strict";var c={cs:"https://cs-studios.demo.learning.amplify.com/wg-curriculum",drm:"https://drm-studios.demo.learning.amplify.com",web:"https://web-studios.demo.learning.amplify.com",dam:"https://dam-studios.demo.learning.amplify.com/share",ereader:"https://drm-preview-studios.demo.learning.amplify.com/ereader",pub:"https://pub-studios.demo.learning.amplify.com"},d="/api/0.1",e="/amp-config.json";b.module("ampConfig",[]).service("ampConfigService",["$q","$http",function(a,f){var g=a.defer(),h=a.defer(),i=function(b){var c=a.defer();return g.promise.then(function(a){c.resolve(a.cs+d+b)}),c.promise},j=function(b){var c=a.defer();return g.promise.then(function(a){c.resolve(a.cs+b)}),c.promise};return f.get(e,{withCredentials:!0}).success(function(a){g.resolve(b.fromJson(a)),h.resolve(b.fromJson(a))}).error(function(){g.resolve(c),h.resolve(c)}),{csBaseUrlBuilder:j,csApiUrlBuilder:i,config:h}}])}(window,window.angular);